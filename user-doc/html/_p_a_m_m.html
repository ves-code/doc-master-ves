<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>PLUMED: PAMM</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.6.0-dev</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_p_a_m_m.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">PAMM </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><table align="center" frame="void" width="95%%" celpadding="5%%">
<tr>
<td width="60%%"></td><td><b> This is part of the pamm <a class="el" href="mymodules.html">module </a></b>   </td></tr>
<tr>
<td width="60%%"></td><td><b> It is only available if you configure PLUMED with ./configure &ndash;enable-modules=pamm . Furthermore, this feature is still being developed so take care when using it and report any problems on the mailing list.</b>   </td></tr>
</table>
<p>Probabilistic analysis of molecular motifs.</p>
<p>Probabilistic analysis of molecular motifs (PAMM) was introduced in this paper <b>[pamm]</b>. The essence of this approach involves calculating some large set of collective variables for a set of atoms in a short trajectory and fitting this data using a Gaussian Mixture Model. The idea is that modes in these distributions can be used to identify features such as hydrogen bonds or secondary structure types.</p>
<p>The assumption within this implementation is that the fitting of the Gaussian mixture model has been done elsewhere by a separate code. You thus provide an input file to this action which contains the means, covariance matrices and weights for a set of Gaussian kernels, \(\{ \phi \}\). The values and derivatives for the following set of quantities is then computed:</p>
<p class="formulaDsp">
\[ s_k = \frac{ \phi_k}{ \sum_i \phi_i } \]
</p>
<p>Each of the \(\phi_k\) is a Gaussian function that acts on a set of quantities calculated within a <a class="el" href="mcolv.html">MultiColvar</a> . These might be <a class="el" href="_t_o_r_s_i_o_n_s.html">TORSIONS</a>, <a class="el" href="_d_i_s_t_a_n_c_e_s.html">DISTANCES</a>, <a class="el" href="_a_n_g_l_e_s.html">ANGLES</a> or any one of the many symmetry functions that are available within <a class="el" href="mcolv.html">MultiColvar</a> actions. These quantities are then inserted into the set of \(n\) kernels that are in the the input file. This will be done for multiple sets of values for the input quantities and a final quantity will be calculated by summing the above \(s_k\) values or some transformation of the above. This sounds less complicated than it is and is best understood by looking through the example given below.</p>
<dl class="section warning"><dt>Warning</dt><dd>Mixing <a class="el" href="mcolv.html">MultiColvar</a> actions that are periodic with variables that are not periodic has not been tested</dd></dl>
<dl class="section user"><dt>Description of components</dt><dd></dd></dl>
<p>When the label of this action is used as the input for a second you are not referring to a scalar quantity as you are in regular collective variables. The label is used to reference the full set of quantities calculated by the action. This is usual when using <a class="el" href="mcolv.html#multicolvarfunction">MultiColvar functions</a>. Generally when doing this the set of PAMM variables will be referenced using the DATA keyword rather than ARG.</p>
<p>This Action can be used to calculate the following scalar quantities directly from the underlying set of PAMM variables. These quantities are calculated by employing the keywords listed below and they can be referenced elsewhere in the input file by using this Action's label followed by a dot and the name of the quantity. The particular PAMM variable that should be averaged in a MEAN command or transformed by a switching function in a LESS_THAN command is specified using the COMPONENT keyword. COMPONENT=1 refers to the PAMM variable in which the first kernel in your input file is on the numerator, COMPONENT=2 refers to PAMM variable in which the second kernel in the input file is on the numerator and so on. The same quantity can be calculated multiple times for different PAMM components by a single PAMM action. In this case the relevant keyword must appear multiple times on the input line followed by a numerical identifier i.e. MEAN1, MEAN2, ... The quantities calculated when multiple MEAN commands appear on the input line can be reference elsewhere in the input file by using the name of the quantity followed followed by a numerical identifier e.g. <em>label</em>.lessthan-1, <em>label</em>.lessthan-2 etc. Alternatively, you can customize the labels of the quantities by using the LABEL keyword in the description of the keyword.</p>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="5%"><b> Quantity </b>  </td><td><b> Keyword </b>  </td><td><b> Description </b>   </td></tr>
<tr>
<td width="5%"><b> altmin </b> </td><td width="10%"><b> ALT_MIN </b>  </td><td>the minimum value. This is calculated using the formula described in the description of the keyword so as to make it continuous.   </td></tr>
<tr>
<td width="5%"><b> between </b> </td><td width="10%"><b> BETWEEN </b>  </td><td>the number/fraction of values within a certain range. This is calculated using one of the formula described in the description of the keyword so as to make it continuous. You can calculate this quantity multiple times using different parameters.   </td></tr>
<tr>
<td width="5%"><b> highest </b> </td><td width="10%"><b> HIGHEST </b>  </td><td>the highest of the quantities calculated by this action   </td></tr>
<tr>
<td width="5%"><b> lessthan </b> </td><td width="10%"><b> LESS_THAN </b>  </td><td>the number of values less than a target value. This is calculated using one of the formula described in the description of the keyword so as to make it continuous. You can calculate this quantity multiple times using different parameters.   </td></tr>
<tr>
<td width="5%"><b> lowest </b> </td><td width="10%"><b> LOWEST </b>  </td><td>the lowest of the quantities calculated by this action   </td></tr>
<tr>
<td width="5%"><b> max </b> </td><td width="10%"><b> MAX </b>  </td><td>the maximum value. This is calculated using the formula described in the description of the keyword so as to make it continuous.   </td></tr>
<tr>
<td width="5%"><b> mean </b> </td><td width="10%"><b> MEAN </b>  </td><td>the mean value. The output component can be referred to elsewhere in the input file by using the label.mean   </td></tr>
<tr>
<td width="5%"><b> min </b> </td><td width="10%"><b> MIN </b>  </td><td>the minimum value. This is calculated using the formula described in the description of the keyword so as to make it continuous.   </td></tr>
<tr>
<td width="5%"><b> moment </b> </td><td width="10%"><b> MOMENTS </b>  </td><td>the central moments of the distribution of values. The second moment would be referenced elsewhere in the input file using <em>label</em>.moment-2, the third as <em>label</em>.moment-3, etc.   </td></tr>
<tr>
<td width="5%"><b> morethan </b> </td><td width="10%"><b> MORE_THAN </b>  </td><td>the number of values more than a target value. This is calculated using one of the formula described in the description of the keyword so as to make it continuous. You can calculate this quantity multiple times using different parameters.   </td></tr>
<tr>
<td width="5%"><b> sum </b> </td><td width="10%"><b> SUM </b>  </td><td>the sum of values   </td></tr>
</table>
<dl class="section user"><dt>Compulsory keywords</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> DATA </b> </td><td>the multicolvars from which the pamm coordinates are calculated   </td></tr>
<tr>
<td width="15%"><b> CLUSTERS </b> </td><td>the name of the file that contains the definitions of all the clusters   </td></tr>
<tr>
<td width="15%"><b> REGULARISE </b> </td><td>( default=0.001 ) don't allow the denominator to be smaller then this value   </td></tr>
</table>
<dl class="section user"><dt>Options</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> NUMERICAL_DERIVATIVES </b> </td><td>( default=off ) calculate the derivatives for these quantities numerically   </td></tr>
<tr>
<td width="15%"><b> NOPBC </b> </td><td>( default=off ) ignore the periodic boundary conditions when calculating distances   </td></tr>
<tr>
<td width="15%"><b> SERIAL </b> </td><td>( default=off ) do the calculation in serial. Do not use MPI   </td></tr>
<tr>
<td width="15%"><b> LOWMEM </b> </td><td>( default=off ) lower the memory requirements   </td></tr>
<tr>
<td width="15%"><b> TIMINGS </b> </td><td><p class="starttd">( default=off ) output information on the timings of the various parts of the calculation  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td width="15%"><b> MEAN </b> </td><td>take the mean of these variables. The final value can be referenced using <em>label</em>.mean. You can use multiple instances of this keyword i.e. MEAN1, MEAN2, MEAN3... The corresponding values are then referenced using <em>label</em>.mean-1, <em>label</em>.mean-2, <em>label</em>.mean-3...   </td></tr>
<tr>
<td width="15%"><b> MORE_THAN </b> </td><td>calculate the number of variables more than a certain target value. This quantity is calculated using \(\sum_i 1.0 - \sigma(s_i)\), where \(\sigma(s)\) is a <a class="el" href="switchingfunction.html">switchingfunction</a>. The final value can be referenced using <em>label</em>.morethan. You can use multiple instances of this keyword i.e. MORE_THAN1, MORE_THAN2, MORE_THAN3... The corresponding values are then referenced using <em>label</em>.morethan-1, <em>label</em>.morethan-2, <em>label</em>.morethan-3...   </td></tr>
<tr>
<td width="15%"><b> SUM </b> </td><td>calculate the sum of all the quantities. The final value can be referenced using <em>label</em>.sum. You can use multiple instances of this keyword i.e. SUM1, SUM2, SUM3... The corresponding values are then referenced using <em>label</em>.sum-1, <em>label</em>.sum-2, <em>label</em>.sum-3...   </td></tr>
<tr>
<td width="15%"><b> LESS_THAN </b> </td><td>calculate the number of variables less than a certain target value. This quantity is calculated using \(\sum_i \sigma(s_i)\), where \(\sigma(s)\) is a <a class="el" href="switchingfunction.html">switchingfunction</a>. The final value can be referenced using <em>label</em>.lessthan. You can use multiple instances of this keyword i.e. LESS_THAN1, LESS_THAN2, LESS_THAN3... The corresponding values are then referenced using <em>label</em>.lessthan-1, <em>label</em>.lessthan-2, <em>label</em>.lessthan-3...   </td></tr>
<tr>
<td width="15%"><b> HISTOGRAM </b> </td><td>calculate how many of the values fall in each of the bins of a histogram. This shortcut allows you to calculates NBIN quantities like BETWEEN. The final value can be referenced using <em>label</em>.histogram. You can use multiple instances of this keyword i.e. HISTOGRAM1, HISTOGRAM2, HISTOGRAM3... The corresponding values are then referenced using <em>label</em>.histogram-1, <em>label</em>.histogram-2, <em>label</em>.histogram-3...   </td></tr>
<tr>
<td width="15%"><b> MIN </b> </td><td>calculate the minimum value. To make this quantity continuous the minimum is calculated using \( \textrm{min} = \frac{\beta}{ \log \sum_i \exp\left( \frac{\beta}{s_i} \right) } \) The value of \(\beta\) in this function is specified using (BETA= \(\beta\)) The final value can be referenced using <em>label</em>.min. You can use multiple instances of this keyword i.e. MIN1, MIN2, MIN3... The corresponding values are then referenced using <em>label</em>.min-1, <em>label</em>.min-2, <em>label</em>.min-3...   </td></tr>
<tr>
<td width="15%"><b> MAX </b> </td><td>calculate the maximum value. To make this quantity continuous the maximum is calculated using \( \textrm{max} = \beta \log \sum_i \exp\left( \frac{s_i}{\beta}\right) \) The value of \(\beta\) in this function is specified using (BETA= \(\beta\)) The final value can be referenced using <em>label</em>.max. You can use multiple instances of this keyword i.e. MAX1, MAX2, MAX3... The corresponding values are then referenced using <em>label</em>.max-1, <em>label</em>.max-2, <em>label</em>.max-3...   </td></tr>
<tr>
<td width="15%"><b> LOWEST </b> </td><td>this flag allows you to recover the lowest of these variables. The final value can be referenced using <em>label</em>.lowest   </td></tr>
<tr>
<td width="15%"><b> HIGHEST </b> </td><td>this flag allows you to recover the highest of these variables. The final value can be referenced using <em>label</em>.highest   </td></tr>
<tr>
<td width="15%"><b> ALT_MIN </b> </td><td>calculate the minimum value. To make this quantity continuous the minimum is calculated using \( \textrm{min} = -\frac{1}{\beta} \log \sum_i \exp\left( -\beta s_i \right) \) The value of \(\beta\) in this function is specified using (BETA= \(\beta\)). The final value can be referenced using <em>label</em>.altmin. You can use multiple instances of this keyword i.e. ALT_MIN1, ALT_MIN2, ALT_MIN3... The corresponding values are then referenced using <em>label</em>.altmin-1, <em>label</em>.altmin-2, <em>label</em>.altmin-3...   </td></tr>
<tr>
<td width="15%"><b> BETWEEN </b> </td><td>calculate the number of values that are within a certain range. These quantities are calculated using kernel density estimation as described on <a class="el" href="histogrambead.html">histogrambead</a>. The final value can be referenced using <em>label</em>.between. You can use multiple instances of this keyword i.e. BETWEEN1, BETWEEN2, BETWEEN3... The corresponding values are then referenced using <em>label</em>.between-1, <em>label</em>.between-2, <em>label</em>.between-3...   </td></tr>
<tr>
<td width="15%"><b> MOMENTS </b> </td><td>calculate the moments of the distribution of collective variables. The mth moment of a distribution is calculated using \(\frac{1}{N} \sum_{i=1}^N ( s_i - \overline{s} )^m \), where \(\overline{s}\) is the average for the distribution. The moments keyword takes a lists of integers as input or a range. Each integer is a value of \(m\). The final calculated values can be referenced using moment- \(m\). You can use the COMPONENT keyword in this action but the syntax is slightly different. If you would like the second and third moments of the third component you would use MOMENTS={COMPONENT=3 MOMENTS=2-3}. The moments would then be referred to using the labels moment-3-2 and moment-3-3. This syntax is also required if you are using numbered MOMENT keywords i.e. MOMENTS1, MOMENTS2...   </td></tr>
</table>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<p>In this example I will explain in detail what the following input is computing:</p>
<pre class="fragment">
<span style="color:blue">#SETTINGS MOLFILE=regtest/basic/rt32/helix.pdb</span>
<a href="./_m_o_l_i_n_f_o.html" style="color:green">MOLINFO</a> MOLTYPE=protein STRUCTURE=M1d.pdb
psi: <a href="./_t_o_r_s_i_o_n_s.html" style="color:green">TORSIONS</a> ATOMS1=@psi-2 ATOMS2=@psi-3 ATOMS3=@psi-4
phi: <a href="./_t_o_r_s_i_o_n_s.html" style="color:green">TORSIONS</a> ATOMS1=@phi-2 ATOMS2=@phi-3 ATOMS3=@phi-4
p: <a href="./_p_a_m_m.html" style="color:green">PAMM</a> DATA=phi,psi CLUSTERS=clusters.pamm MEAN1={COMPONENT=1} MEAN2={COMPONENT=2}
<a href="./_p_r_i_n_t.html" style="color:green">PRINT</a> ARG=p.mean-1,p.mean-2 FILE=colvar
</pre><p>The best place to start our explanation is to look at the contents of the clusters.pamm file</p>
<pre class="fragment">#! FIELDS height phi psi sigma_phi_phi sigma_phi_psi sigma_psi_phi sigma_psi_psi
#! SET multivariate von-misses
#! SET kerneltype gaussian
      2.97197455E-0001     -1.91983118E+0000      2.25029540E+0000      2.45960237E-0001     -1.30615381E-0001     -1.30615381E-0001      2.40239117E-0001
      2.29131448E-0002      1.39809354E+0000      9.54585380E-0002      9.61755708E-0002     -3.55657919E-0002     -3.55657919E-0002      1.06147253E-0001
      5.06676398E-0001     -1.09648066E+0000     -7.17867907E-0001      1.40523052E-0001     -1.05385552E-0001     -1.05385552E-0001      1.63290557E-0001
</pre><p>This files contains the parameters of two two-dimensional Gaussian functions. Each of these Gaussian kernels has a weight, \(w_k\), a vector that specifies the position of its center, \(\mathbf{c}_k\), and a covariance matrix, \(\Sigma_k\). The \(\phi_k\) functions that we use to calculate our PAMM components are thus:</p>
<p class="formulaDsp">
\[ \phi_k = \frac{w_k}{N_k} \exp\left( -(\mathbf{s} - \mathbf{c}_k)^T \Sigma^{-1}_k (\mathbf{s} - \mathbf{c}_k) \right) \]
</p>
<p>In the above \(N_k\) is a normalization factor that is calculated based on \(\Sigma\). The vector \(\mathbf{s}\) is a vector of quantities that are calculated by the <a class="el" href="_t_o_r_s_i_o_n_s.html">TORSIONS</a> actions. This vector must be two dimensional and in this case each component is the value of a torsion angle. If we look at the two <a class="el" href="_t_o_r_s_i_o_n_s.html">TORSIONS</a> actions in the above we are calculating the \(\phi\) and \(\psi\) backbone torsional angles in a protein (Note the use of <a class="el" href="_m_o_l_i_n_f_o.html">MOLINFO</a> to make specification of atoms straightforward). We thus calculate the values of our 2 \( \{ \phi \} \) kernels 3 times. The first time we use the \(\phi\) and \(\psi\) angles in the second residue of the protein, the second time it is the \(\phi\) and \(\psi\) angles of the third residue of the protein and the third time it is the \(\phi\) and \(\psi\) angles of the fourth residue in the protein. The final two quantities that are output by the print command, p.mean-1 and p.mean-2, are the averages over these three residues for the quantities: </p><p class="formulaDsp">
\[ s_1 = \frac{ \phi_1}{ \phi_1 + \phi_2 } \]
</p>
<p> and </p><p class="formulaDsp">
\[ s_2 = \frac{ \phi_2}{ \phi_1 + \phi_2 } \]
</p>
<p> There is a great deal of flexibility in this input. We can work with, and examine, any number of components, we can use any set of collective variables and compute these PAMM variables and we can transform the PAMM variables themselves in a large number of different ways when computing these sums. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="colvarintro.html">Collective Variables</a></li><li class="navelem"><a class="el" href="mcolv.html">MultiColvar</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
