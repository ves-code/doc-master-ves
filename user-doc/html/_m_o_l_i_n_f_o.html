<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>PLUMED: MOLINFO</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.6.0-dev</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_m_o_l_i_n_f_o.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">MOLINFO </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><table align="center" frame="void" width="95%%" celpadding="5%%">
<tr>
<td width="70%%"></td><td><b> This is part of the setup <a class="el" href="mymodules.html">module </a></b>   </td></tr>
</table>
<p>This command is used to provide information on the molecules that are present in your system.</p>
<p>The information on the molecules in your system can either be provided in the form of a pdb file or as a set of lists of atoms that describe the various chains in your system. If a pdb file is used plumed the MOLINFO command will endeavor to recognize the various chains and residues that make up the molecules in your system using the chainIDs and resnumbers from the pdb file. You can then use this information in later commands to specify atom lists in terms residues. For example using this command you can find the backbone atoms in your structure automatically.</p>
<dl class="section warning"><dt>Warning</dt><dd>Please be aware that the PDB parser in plumed is far from perfect. You should thus check the log file and examine what plumed is actually doing whenever you use the MOLINFO action. Also make sure that the atoms are listed in the pdb with the correct order. If you are using gromacs, the safest way is to use reference pdb file generated with <code>gmx editconf -f topol.tpr -o reference.pdb</code>.</dd></dl>
<p>More information of the PDB parser implemented in PLUMED can be found <a class="el" href="pdbreader.html">at this page</a>.</p>
<p>Providing <code>MOLTYPE=protein</code>, <code>MOLTYPE=rna</code>, or <code>MOLTYPE=dna</code> will instruct plumed to look for known residues from these three types of molecule. In other words, this is available for historical reasons and to allow future extensions where alternative lists will be provided. As of now, you can just ignore this keyword.</p>
<p>Using <a class="el" href="_m_o_l_i_n_f_o.html">MOLINFO</a> extends the possibility of atoms selection using the @ special symbol. The following shortcuts are available that do not refer to one specific residue:</p>
<pre class="fragment">@nucleic : all atoms that are part of a DNA or RNA molecule
@protein : all atoms that are part of a protein
@water : all water molecules
@ions : all the ions
@hydrogens : all hydrogen atoms (those for which the first non-number in the name is a H)
@nonhydrogens : all non hydrogen atoms (those for which the first non-number in the name is not a H)
</pre><dl class="section warning"><dt>Warning</dt><dd>Be careful since these choices are based on common names used in PDB files. Always check if the selected atoms are correct.</dd></dl>
<p>In addition, atoms from a specific residue can be selected with a symbol in this form:</p>
<pre class="fragment">@"definition"-chain_residuenum
@"definition"-chainresiduenum
@"definition"-residuenum
</pre><p>So for example</p>
<pre class="fragment">@psi-1 will select the atoms defining the psi torsion of residue 1
@psi-C1  or @psi-C_1 will define the same torsion for residue 1 of chain C.
@psi-3_1 will define the same torsion for residue 1 of chain 3.
</pre><p>Using the underscore to separate chain and residue is available as of PLUMED 2.5 and allows selecting chains with a numeric id.</p>
<p>In the following are listed the current available definitions:</p>
<p>For protein residues, the following groups are available:</p>
<pre class="fragment">@phi-#
@psi-#
@omega-#
@chi1-#
@chi2-#
@chi3-#
@chi4-#
@chi5-#
</pre><p>that select the appropriate atoms that define each dihedral angle for residue #.</p>
<p>For DNA or RNA residues, the following groups are available:</p>
<pre class="fragment"># quadruplets for backbone dihedral angles
@alpha-#
@beta-#
@gamma-#
@delta-#
@epsilon-#
@zeta-#

# quadruplets for sugar dihedral angles
@v0-#
@v1-#
@v2-#
@v3-#
@v4-#

# quadruplet corresponding to the chi torsional angle
@chi-#

# backbone, sugar, and base heavy atoms
@back-#
@sugar-#
@base-#

# ordered triplets of atoms on the 6-membered ring of nucleobases
# namely:
#  C2/C4/C6 for pyrimidines
#  C2/C6/C4 for purines
@lcs-#
</pre><p>Notice that <code>zeta</code> and <code>epsilon</code> groups should not be used on 3' end residue and <code>alpha</code> and <code>beta</code> should not be used on 5' end residue.</p>
<p>Furthermore it is also possible to pick single atoms using the syntax <code>atom-chain_residuenum</code>, <code>@atom-chainresiduenum</code> or <code>@atom-residuenum</code>. As of PLUMED 2.5, this also works when the residue is not a protein/rna/dna residue. For instance, <code>@OW-100</code> will select oxygen of water molecule with residue number 100.</p>
<p>Finally, notice that other shortcuts are available even when not using the <a class="el" href="_m_o_l_i_n_f_o.html">MOLINFO</a> command (see <a class="el" href="_group.html#atomSpecs">Specifying Atoms</a>).</p>
<dl class="section warning"><dt>Warning</dt><dd>If a residue-chain is repeated twice in the reference pdb only the first entry will be selected.</dd></dl>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000003">Bug:</a></b></dt><dd>At the moment the HA1 atoms in a GLY residues are treated as if they are the CB atoms. This may or may not be true - GLY is problematic for secondary structure residues as it is achiral.</dd></dl>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000004">Bug:</a></b></dt><dd>If you use WHOLEMOLECULES RESIDUES=1-10 for a 18 amino acid protein ( 18 amino acids + 2 terminal groups = 20 residues ) the code will fail as it will not be able to interpret terminal residue 1.</dd></dl>
<dl class="section user"><dt>Advanced atom selection with mdtraj or MDAnalysis</dt><dd></dd></dl>
<p>Since PLUMED 2.6 it is possible to use the expressive selection syntax of <a href="http://mdtraj.org/latest/atom_selection.html">mdtraj</a> and/or <a href="https://www.mdanalysis.org/docs/documentation_pages/selections.html">MDAnalysis</a>:</p>
<pre class="fragment">
<a href="./_m_o_l_i_n_f_o.html" style="color:green">MOLINFO</a> STRUCTURE=helix.pdb PYTHON_BIN=python
g1: <a href="./_g_r_o_u_p.html" style="color:green">GROUP</a> ATOMS=@mda:backbone
g2: <a href="./_g_r_o_u_p.html" style="color:green">GROUP</a> ATOMS={@mda:{resnum 1 or resid 3:5}}
g3: <a href="./_g_r_o_u_p.html" style="color:green">GROUP</a> ATOMS={@mda:{resid 3:5} @mda:{resnum 1}}
g4: <a href="./_g_r_o_u_p.html" style="color:green">GROUP</a> ATOMS={@mdt:{protein and (backbone or resname ALA)}}
g5: <a href="./_g_r_o_u_p.html" style="color:green">GROUP</a> ATOMS={@mdt:{mass 5.5 to 20}} <span style="color:blue"># masses guessed by mdtraj based on atom type!</span>
g6: <a href="./_g_r_o_u_p.html" style="color:green">GROUP</a> ATOMS={@mda:{resid 3:5} @mda:{resnum 1} 1-10}
</pre><p>Here <code>@mda:</code> indicates that <code>MDAnalysis</code> language is used, whereas <code>@mdt:</code> indicates that <code>mdtraj</code> language is used. Notice that these languages typically select atoms in order. If you want to specify a different order, you can chain definitions as in <code>g3</code> above (compare with <code>g2</code>). Selections can be also chained with standard PLUMED selections (see <code>g6</code>).</p>
<p>The double braces are required due to the way PLUMED parses atom lists. In particular:</p>
<ul>
<li>The outer braces are needed to show PLUMED where the <code>ATOMS=...</code> option ends.</li>
<li>The inner braces are needed to show PLUMED where each selector ends.</li>
</ul>
<p>MDAnalysis also supports geometric selectors based on atomic coordinates. These selectors <b>are static</b> and return lists computed using the coordinates stored in the <code>MOLINFO</code> pdb file.</p>
<p>In order to use this syntax you should check the following points at runtime:</p>
<ol type="1">
<li><code>plumed --no-mpi config has subprocess</code> prints <code>subprocess on</code> (should be ok on most UNIX systems).</li>
<li><p class="startli">You have a python interpreter with mdtraj and/or MDAnalysis installed. You can check using:</p><ul>
<li><code>python -c "import mdtraj"</code></li>
<li><code>python -c "import MDAnalysis"</code></li>
</ul>
<p class="startli">In order to install these packages refer to their documentation. Pip or conda install should be ok, provided you make sure the correct python interpreter is in the execution PATH at runtime. Notice that you will only need the package(s) related to the syntax that you want to use.</p>
</li>
<li><p class="startli">In case you installed these modules on a python with a different name (e.g. <code>python3.6</code>), the correct check is:</p><ul>
<li><code>python3.6 -c "import mdtraj"</code></li>
<li><code>python3.6 -c "import MDAnalysis"</code></li>
</ul>
<p class="startli">If this is the case, you should set the environment variable <code>export PYTHON_BIN=python3.6</code> or <code>export PLUMED_PYTHON_BIN=python3.6</code> (higher priority). Alternatively, directly provide the interpreter in the PLUMED input file using <code>MOLINFO PYTHON_BIN=python3.6</code> (even higher priority).</p>
</li>
<li>The PDB file that you provide to <code>MOLINFO</code> should have consecutive atom numbers starting from 1. This is currently enforced since reading atom numbers out of order (as PLUMED does) is not supported by other packages.</li>
</ol>
<dl class="section user"><dt>Advanced atom selection with VMD (experimental)</dt><dd></dd></dl>
<p>Similarly to the <code>@mda:</code> and <code>@mdt:</code> selectors above, you can use the two following selectors in order to access to <a href="https://www.ks.uiuc.edu/Research/vmd/">VMD</a> syntax for atoms selection:</p><ul>
<li><code>@vmdexec:</code>: This selector launches an instance of VMD, so <code>vmd</code> executable should be in your execution path. Might be very slow or even crash your simulation. Notice that even if <code>vmd</code> executable is used, the implementation is still python based and so a working python interpreter should be provided.</li>
<li><code>@vmd:</code>: This selector tries to import the <code>vmd</code> python module. Notice that the best way to obtain this module is not within the standard VMD installer but rather by installing the python module that can be found at <a href="http://github.com/Eigenstate/vmd-python">this link</a>. The module is also available on <a href="https://anaconda.org/conda-forge/vmd-python">conda</a>. You should make sure the module is available in the python interpreter used by MOLINFO (check using the command <code>python -c "import vmd"</code>).</li>
</ul>
<p>These two selectors are experimental and might be removed at some point.</p>
<dl class="section user"><dt>The atoms involved can be specified using</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> CHAIN </b> </td><td>(for masochists ( mostly Davide Branduardi ) ) The atoms involved in each of the chains of interest in the structure.. For more information on how to specify lists of atoms see <a class="el" href="_group.html">Groups and Virtual Atoms</a>   </td></tr>
</table>
<dl class="section user"><dt>Compulsory keywords</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> STRUCTURE </b> </td><td>a file in pdb format containing a reference structure. This is used to defines the atoms in the various residues, chains, etc . For more details on the PDB file format visit <a href="http://www.wwpdb.org/docs.html">http://www.wwpdb.org/docs.html</a>   </td></tr>
<tr>
<td width="15%"><b> MOLTYPE </b> </td><td>( default=protein ) what kind of molecule is contained in the pdb file - usually not needed since protein/RNA/DNA are compatible   </td></tr>
<tr>
<td width="15%"><b> PYTHON_BIN </b> </td><td>( default=default ) python interpreter   </td></tr>
</table>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<p>In the following example the MOLINFO command is used to provide the information on which atoms are in the backbone of a protein to the ALPHARMSD CV.</p>
<pre class="fragment">
<span style="color:blue">#SETTINGS MOLFILE=regtest/basic/rt32/helix.pdb</span>
<a href="./_m_o_l_i_n_f_o.html" style="color:green">MOLINFO</a> STRUCTURE=reference.pdb
<a href="./_a_l_p_h_a_r_m_s_d.html" style="color:green">ALPHARMSD</a> RESIDUES=all TYPE=DRMSD LESS_THAN={RATIONAL R_0=0.08 NN=8 MM=12} LABEL=a
</pre><p>The following example prints the distance corresponding to the hydrogen bonds in a GC Watson-Crick pair.</p>
<pre class="fragment">
<span style="color:blue">#SETTINGS MOLFILE=regtest/basic/rt-ermsd/ref.pdb</span>
<a href="./_m_o_l_i_n_f_o.html" style="color:green">MOLINFO</a> STRUCTURE=reference.pdb MOLTYPE=dna
hb1: <a href="./_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> ATOMS=@N2-2,@O2-15
hb2: <a href="./_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> ATOMS=@N1-2,@N3-15
hb3: <a href="./_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> ATOMS=@O6-2,@N4-15
<a href="./_p_r_i_n_t.html" style="color:green">PRINT</a> ARG=hb1,hb2,hb3
</pre><p>This example use MOLINFO to calculate torsion angles</p>
<pre class="fragment">
<span style="color:blue">#SETTINGS MOLFILE=regtest/basic/rt32/helix.pdb</span>
<a href="./_m_o_l_i_n_f_o.html" style="color:green">MOLINFO</a> MOLTYPE=protein STRUCTURE=myprotein.pdb
t1: <a href="./_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> ATOMS=@phi-3
t2: <a href="./_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> ATOMS=@psi-4
<a href="./_p_r_i_n_t.html" style="color:green">PRINT</a> ARG=t1,t2 FILE=colvar STRIDE=10
</pre> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="colvarintro.html">Collective Variables</a></li><li class="navelem"><a class="el" href="_group.html">Groups and Virtual Atoms</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
